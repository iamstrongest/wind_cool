import{_ as b,h as w,M as v,G as h,r as y,o as p,c as f,a as e,k as o,j as R,I as n,J as m,L as V}from"./D6zXq4_Q.js";const x={class:"form_container"},D={class:"form_col file"},I={for:"file",class:"flie_label"},S={for:"file",class:"flie_label"},k=["src"],A={class:"form_col"},F={for:"username"},T={class:"form_col"},U={for:"email"},z={class:"form_col"},B={for:"password"},C={__name:"Register",setup(M){const c=w(),u=v("file"),s=h({password:"",email:"",username:""}),i=y(),_=async()=>{const t=new FormData,a=u.value.files[0];if(!(a&&/^(image\/jpeg|image\/png|image\/gif|image\/bmp|image\/webp)$/.test(a.type))){alert("Valid image file.");return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(s.email)){alert("Invalid email address.");return}if(s.password.length<6){alert("注册密码不能少于6位数");return}if(s.username.length==0){alert("注册昵称不能为空");return}t.append("file",a),t.append("fileName",a.name.split(".")[0]),t.append("timestamp",Date.now()),t.append("email",s.email),t.append("password",s.password),t.append("username",s.username);try{const r=await c.registerFn(t);console.log("上传成功:",r.data),s.email="",s.password="",s.username="",r.code==200&&alert(r.message)}catch(r){console.error("上传失败:",r)}},g=t=>{const a=t.target.files[0],l=new FileReader;l.onload=function(d){const r=d.target.result;i.value=r},l.readAsDataURL(a)};return(t,a)=>(p(),f("div",x,[e("form",{onSubmit:V(_,["prevent"])},[e("div",D,[e("label",I,[a[3]||(a[3]=e("span",null,"上传头像: ",-1)),e("input",{type:"file",name:"file",ref:"file",id:"file",onChange:g},null,544)]),e("label",S,[o(i)?(p(),f("img",{key:0,src:o(i),alt:"预览"},null,8,k)):R("",!0)])]),e("div",A,[e("label",F,[n(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=l=>o(s).username=l),id:"username",name:"username",placeholder:"输入昵称"},null,512),[[m,o(s).username]])])]),e("div",T,[e("label",U,[n(e("input",{type:"email","onUpdate:modelValue":a[1]||(a[1]=l=>o(s).email=l),id:"email",name:"email",placeholder:"输入邮箱"},null,512),[[m,o(s).email]])])]),e("div",z,[e("label",B,[n(e("input",{type:"password","onUpdate:modelValue":a[2]||(a[2]=l=>o(s).password=l),id:"password",name:"password",placeholder:"输入密码"},null,512),[[m,o(s).password]])])]),a[4]||(a[4]=e("div",{class:"form_col submit"},[e("label",{for:"submit"},[e("button",{type:"submit",name:"submit",id:"submit"},"注册")])],-1))],32)]))}},Z=b(C,[["__scopeId","data-v-ef8c4ae0"]]);export{Z as default};

{"version":3,"file":"Register-Cyuv8axQ.js","sources":["../../../../components/form/Register.vue"],"sourcesContent":["<script setup>\r\nconst glboalStore = useGlboalStore();\r\nconst fileRef = useTemplateRef('file');\r\nconst registerForm = reactive({\r\n    password: \"\",\r\n    email: \"\",\r\n    username: \"\"\r\n})\r\nconst base64 = ref();\r\nconst onSubmit = async () => {\r\n    const formData = new FormData();\r\n    const file = fileRef.value.files[0];\r\n    const validImageTypes = /^(image\\/jpeg|image\\/png|image\\/gif|image\\/bmp|image\\/webp)$/;\r\n    if (!(file && validImageTypes.test(file.type))) {\r\n        alert('Valid image file.');\r\n        return;\r\n    }\r\n    const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\r\n    if (!emailPattern.test(registerForm.email)) {\r\n        alert('Invalid email address.');\r\n        return;\r\n    }\r\n    if (registerForm.password.length < 6) {\r\n        alert('注册密码不能少于6位数');\r\n        return;\r\n    }\r\n    if (registerForm.username.length == 0) {\r\n        alert('注册昵称不能为空');\r\n        return;\r\n    }\r\n    formData.append('file', file);\r\n    formData.append('fileName', file.name.split('.')[0]);\r\n    formData.append('timestamp', Date.now());\r\n    formData.append('email', registerForm.email);\r\n    formData.append('password', registerForm.password);\r\n    formData.append('username', registerForm.username);\r\n    try {\r\n        // 使用 axios 发送 POST 请求\r\n        const resp = await glboalStore.registerFn(formData);\r\n        console.log('上传成功:', resp.data);\r\n        registerForm.email = '';\r\n        registerForm.password = '';\r\n        registerForm.username = '';\r\n        if (resp.code == 200) {\r\n            alert(resp.message);\r\n        }\r\n    } catch (error) {\r\n        console.error('上传失败:', error);\r\n    }\r\n}\r\nconst onChange = (event) => {\r\n    const file = event.target.files[0];\r\n    const reader = new FileReader();\r\n    reader.onload = function (e) {\r\n        const base64String = e.target.result; // 获取文件的 Base64 字符串\r\n        base64.value = base64String; // 显示预览\r\n    };\r\n    reader.readAsDataURL(file);\r\n}\r\n</script>\r\n<template>\r\n    <div class=\"form_container\">\r\n        <form @submit.prevent=\"onSubmit\">\r\n            <div class=\"form_col file\">\r\n                <label for=\"file\" class=\"flie_label\">\r\n                    <span>上传头像: </span>\r\n                    <input type=\"file\" name=\"file\" ref=\"file\" id=\"file\" @change=\"onChange\">\r\n                </label>\r\n                <label for=\"file\" class=\"flie_label\">\r\n                    <img :src=\"base64\" alt=\"预览\" v-if=\"base64\">\r\n                </label>\r\n            </div>\r\n            <div class=\"form_col\">\r\n                <label for=\"username\"><input type=\"text\" v-model=\"registerForm.username\" id=\"username\" name=\"username\"\r\n                        placeholder=\"输入昵称\"> </label>\r\n            </div>\r\n            <div class=\"form_col\">\r\n                <label for=\"email\"><input type=\"email\" v-model=\"registerForm.email\" id=\"email\" name=\"email\"\r\n                        placeholder=\"输入邮箱\"> </label>\r\n            </div>\r\n            <div class=\"form_col\">\r\n                <label for=\"password\"><input type=\"password\" v-model=\"registerForm.password\" id=\"password\"\r\n                        name=\"password\" placeholder=\"输入密码\"> </label>\r\n            </div>\r\n            <div class=\"form_col submit\">\r\n                <label for=\"submit\"><button type=\"submit\" name=\"submit\" id=\"submit\">注册</button> </label>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</template>\r\n<style scoped>\r\n.form_container {\r\n    width: 300px;\r\n    height: 400px;\r\n    box-sizing: border-box;\r\n    border: 2px solid #ccc;\r\n    border-radius: 4px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.form_col {\r\n    margin-bottom: 20px;\r\n\r\n}\r\n\r\n.flie_label div {\r\n    cursor: pointer;\r\n    width: 50px;\r\n    height: 50px;\r\n}\r\n\r\n.flie_label img {\r\n    width: 40px;\r\n    height: 40px;\r\n}\r\n\r\n.flie_label {\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-items: center;\r\n}\r\n\r\n.submit {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.form_col button {\r\n    width: 50px;\r\n    height: 30px;\r\n    border: 2px solid #55bfa0;\r\n    border-radius: 4px;\r\n    color: #50b9fe;\r\n    background-color: #fff;\r\n}\r\n\r\ninput {\r\n    width: 200px;\r\n    height: 40px;\r\n    border-radius: 20px;\r\n}\r\n\r\n#file {\r\n    border-radius: 0;\r\n}\r\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AACoB,mBAAiB;AACrB,mBAAe,MAAM;AACrC,UAAM,eAAe,SAAS;AAAA,MAC1B,UAAU;AAAA,MACV,OAAO;AAAA,MACP,UAAU;AAAA,IACd,CAAC;AACD,UAAM,SAAS,IAAG;;;;;;;;;;;;;;;;;;;"}